# 模型架构

![image-20221001115947942](https://typora-nigel.oss-cn-nanjing.aliyuncs.com/img/image-20221001115947942.png)

前提假设：

1、每个样本有4个特征，表示为$X_{1}$ 到 $X_{4}$ 

2、需要预测的类有三类，分别为 $y_{1}$ 到 $y_{3}$

## 第一层

输入样本的数据



## 第二层

利用第一层输入的数据（$X_{1}$ 到 $X_{4}$），通过线性计算，得到第二层的值$O_{1}$到$O_{3}$。为什么是到$O_{3}$？因为我们假设是一共有三类，所以要分别计算每一类的值



## 第三层

利用softmax函数，将$O_{1}$到$O_{3}$转换为概率值，输出为该样本预测为每一类的概率：$P(y_{1})$ 到 $P(y_{3})$



## 总体思路

类似于logistics回归，只是将logistics中的sigmoid函数变为softmax函数。

在logistics回归中，我们先计算线性映射后的Y值，如下图
$$
Y=W^{T}X+b
$$
类似的，在softmax中也是这样做的。以前面为例，我们可以写出如下详细式子
$$
\begin{bmatrix}
O_{1}\\
\vdots
\\O_{3}
\end{bmatrix}
=\begin{bmatrix}
w_{11}\ w_{12}\ w_{13}\ w_{14}\\
w_{21}\ w_{22}\ w_{23}\ w_{24}\\
w_{31}\ w_{32}\ w_{33}\ w_{34}\\
\end{bmatrix}
\begin{bmatrix}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}\\
\end{bmatrix}+
\begin{bmatrix}
b_{1}\\
b_{2}\\
b_{3}\\
\end{bmatrix}
$$


解释一下：

1、我们先看矩阵$W$ 

- 根据行的展开看，$w_{11}$ 到$w_{14}$ 表示的是：对于要预测的第一类，样本的每个特征前面要乘以的系数。简单来说，就是预测某一类时，特征前系数
- 我们一共有三行，表示我们要对这个样本，分别计算它在这三类中的预测数值，即$O_{1}$到$O_{3}$

2、$b_{1}$ $b_{2}$ $b_{3}$ 表示的是预测相应类的时候的偏移量，可以理解为线性回归中的截距



之后，在softmax层，我们利用softmax函数将$O_{1-3}$ 映射到区间[0,1]中，表示为概率。softmax函数如下：
$$
softmax(O_{j})=\frac {e^{O_{j}}}{\sum _{i=1}^{k}e^{O_{i}}}
$$
这样我们就可以得到一个样本预测为不同类的概率值了







# 损失函数（交叉熵）

