https://cloud.tencent.com/document/product/560/83381

选择GPU机型



# Linux clone github

原链接：https://github.com/PanJinquan/tensorflow_models_learning.git

改成镜像：https://gitclone.com/github.com/PanJinquan/tensorflow_models_learning.git

==加一个gitclone.com在前面==



# 服务器环境配置

GPU-DRIVER=470.82.01
CUDA=11.4.3_470.82.01
cuDNN=11.4-8.2.4.15
Miniconda=py38_4.11.0
Pytorch=1.9.1
Torchvision=0.10.0
OpenCV=4.6.0.66

<img src="https://typora-nigel.oss-cn-nanjing.aliyuncs.com/img/image-20230208190404757.png" alt="image-20230208190404757" style="zoom: 80%;" />

# 注意

==jupyter的所有内容都是在ubuntu用户下的==









## jupyter 配置文件

！！！！sudo vim 文件地址

sudo vim /home/ubuntu/.jupyter/jupyter_notebook_config.py

8888端口的默认都是在ubuntu用户下的操作

需要添加：

```
c.NotebookApp.ip='*'
c.NotebookApp.notebook_dir = '/home/ubuntu/notebook'
c.NotebookApp.password = u'密码'
c.NotebookApp.allow_remote_access = True
c.NotebookApp.allow_root = True
```



## jupyter 添加kernel

```
1、激活conda 虚拟环境
2、pip install ipykernel
3、 whereis python ----> return 一个路径A
4、sudo 路径A -m ipykernel install --name 取名字


sudo /usr/local/miniconda3/envs/pt190/bin/python -m ipykernel install --name pt190
```

==这里添加了的kernel可以直接在vscode中找到了，很方便，可以用作往vscode中添加环境的方法==



## 添加jupyterlab

直接在ubuntu下，pip install jupyterlab
然后重启就行



# 15天的活动专区

## 配置jupyter

1、生成jupyter 配置文件

```
jupyter notebook --generate-config --allow-root

## /home/ubuntu/.jupyter/jupyter_notebook_config.py
```

2、生成密码Hash 

```
命令行输入：ipython
In [1]: from notebook.auth import passwd
In [2]: passwd()
Enter password:  # 此处输入密码
Verify password: # 验证密码
Out[2]: 'sha1:xxx
```



3、不要密码

```
vim ~/.jupyter/jupyter_notebook_config.py
按键：shift+ :
输入?+[查找内容]
#查找内容：?c.NotebookApp.password_required = False
```



## VSCode

### 配置ssh

本地的公钥摆到服务器上

1、通过WINSCP 传到自己知道的路径，然后修改其名字

```
cat id_rsa.pub >> authorized_keys
```

2、移动文件到./ssh

```
mv authorized_keys  ~/.ssh
```



### VScode 拓展

1、https://marketplace.visualstudio.com/vscode 下载插件（现在vscode上找到本地的插件的版本号，然后替换url相应部分）

2、传到服务器上

3、在vscode中连接服务器，管理拓展右上角三个点，点击，选择“从VSIX按照“





## 连接jupyter

输入http://ip:8888，然后输入密码







# 环境

常用：tf----->2.11.0

激活环境：source activate



## 移除环境

1、切换到root

2、conda env remove -n name



## 创建环境

1、切换到root

2、conda create -n name python==3.8.0



## 移除kernel

切换到root

1、jupyter kernelspec list

2、jupyter kernelspec uninstall 不需要kernel





# 竞价实例镜像

选择公共镜像，ubuntu 18.04为例、cuda：11.2.2 、cudnn :8.2.1

一般15-20分钟后才能用

[主要参照文章](https://cloud.tencent.com/developer/article/1994265)

1、连接vscode（参照上面）

注意：记得配置那个ssh的config文件里面的User

2、安装miniconda

```
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
 
chmod a+x Miniconda3-latest-Linux-x86_64.sh
 
./Miniconda3-latest-Linux-x86_64.sh
```



3、

```
1、source ~/.bashrc
2、这时候会激活base环境，就选择base环境作为jupyter服务的环境
3、下载：pip install jupyter
4、按照配置jupyter配置
5、利用screen 实现一直运行服务器
6、重新创建个环境，并且加入到jupyter中
6、vscode连接jupyter环境

```









sudo sh NVIDIA-Linux-x86_64-460.106.00.run --dkms

## 直接选择镜像

驱动问题：

1、启动nvcc

```
cd /usr/local/cuda/bin
vim ~/.bashrc
在文件最后添加
export LD_LIBRARY_PATH=/usr/local/cuda/lib
export PATH=$PATH:/usr/local/cuda/bin
source ~/.bashrc
```





# Screen

```
1、screen -S {name} 创建screen
2、screen -ls  查看
3、screen -r id 激活
4、ctrl+a+d 退出
```

